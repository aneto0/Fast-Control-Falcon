+StateMachine = {
	Class = StateMachine
	+INITIAL = {
    	Class = ReferenceContainer    	
    	+START = {
    		Class = StateMachineEvent
    		NextState = "IDLE"
			NextStateError = "IDLE"
    		Timeout = 0    		
    		+ChangeToIdleMsgPLCSDN = {
        		Class = Message
        		Destination = PLCSDNApp
        		Mode = ExpectsReply
        		Function = PrepareNextState
        		+Parameters = {
        			Class = ConfigurationDatabase
        			param1 = Idle
        		}
        	}
			+StartNextStateExecutionMsgPLCSDN = {
        		Class = Message
        		Destination = PLCSDNApp
        		Function = StartNextStateExecution
        		Mode = ExpectsReply
        	}
    	}    	
	}
	+IDLE = {
    	Class = ReferenceContainer    	
        +ERROR = {
    		Class = StateMachineEvent
    		NextState = "IDLE"
    		NextStateError = "IDLE"
        }
    }   
}

$PLCSDNApp = {
    Class = RealTimeApplication
    +Functions = {
        Class = ReferenceContainer
		+GAMTimer = {
        	Class = IOGAM
        	InputSignals = {
        		Counter = {
        			Type = uint32
        			DataSource = Timer
        		}
        		Time = {
        			Type = uint32
        			DataSource = Timer
        			Frequency = 0.2
        		}
        	}
        	OutputSignals = {
        		Counter = {
        			Type = uint32
        			DataSource = LoggerDataSource
        		}
        		Time = {
        			Type = uint32
        			DataSource = DDB1        			
        		}
        	}
        }
        +GAMCMD = {
        	Class = ConstantGAM
        	OutputSignals = {
        		Command1 = {
                     Type = uint8
                     NumberOfElements = 1
                     Default = 1
                     DataSource = DDB1                     
                }                
        	}
        }    
        +GAMSDNPub = {
        	Class = IOGAM
        	InputSignals = {
        		Command1 = {
                     Type = uint8
                     NumberOfElements = 1
                     Default = 1
                     DataSource = DDB1                     
                }
        	}
        	OutputSignals = {
        		Command1 = {
                     Type = uint8
                     NumberOfElements = 1
                     DataSource = SDNPub
                     Trigger = 1                     
                }                
        	}
        }
	}
    +Data = {
        Class = ReferenceContainer
        DefaultDataSource = DDB1
        +DDB1 = {
        	Class = GAMDataSource
       	}    
       	+Timer = {
       		Class = LinuxTimer
       		Signals = {
       			Counter = {
       				Type = uint32
       			}
       			Time = {
       				Type = uint32
       			}
       		}
       	}    
       	+SDNPub = {
            Class = SDN::SDNPublisher            
            Interface = lo
            Address = "127.0.0.1:44444"
            Topic = Ignored
            //Timeout = 1000
            Signals = {
            	PLCHeader = {
                     Type = uint8
                     NumberOfElements = 8
                }
                Floats = {
            		Type = float32
                	NumberOfElements = 1
					NumberOfDimensions = 1
            	}
				Integers = {
                	Type = uint16
					NumberOfElements = 1     
					NumberOfDimensions = 1
                }
                Command1 = {
                	Type = uint8
					NumberOfElements = 1     
					NumberOfDimensions = 1
                }
                Command2 = {
                	Type = uint8
					NumberOfElements = 1     
					NumberOfDimensions = 1
                }
                States = {
                	Type = uint8
					NumberOfElements = 1     
					NumberOfDimensions = 1
                }
                Alarms = {
                	Type = uint8
					NumberOfElements = 1     
					NumberOfDimensions = 1
                }
                Spares = {
                	Type = uint8
					NumberOfElements = 90     
					NumberOfDimensions = 1
                }
            }               
        } 
        +LoggerDataSource = {
            Class = LoggerDataSource
        }
        +Timings = {
            Class = TimingDataSource
        }        
    }
    +States = {
        Class = ReferenceContainer
        +Idle = {
            Class = RealTimeState
            +Threads = {
                Class = ReferenceContainer
                +Thread1 = {
                    Class = RealTimeThread
                    CPUs = 0x1
                    Functions = {GAMTimer GAMCMD GAMSDNPub}
                }
            }
        }
    }
    +Scheduler = {
        Class = GAMScheduler
        TimingDataSource = Timings
    }
}
